---
/**
 * ConfirmModal Component - Modal de confirmación
 * Para acciones destructivas como eliminar
 */
---

<div 
  x-data="confirmModal()" 
  x-on:show-confirm.window="show($event.detail)"
  x-show="isOpen"
  x-cloak
  class="fixed inset-0 z-50 flex items-center justify-center p-4"
  id="confirm-modal"
>
  <!-- Backdrop -->
  <div 
    class="absolute inset-0 bg-black/50 transition-opacity"
    x-show="isOpen"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    @click="cancel()"
  ></div>
  
  <!-- Modal -->
  <div 
    x-show="isOpen"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 scale-95"
    x-transition:enter-end="opacity-100 scale-100"
    x-transition:leave="transition ease-in duration-150"
    x-transition:leave-start="opacity-100 scale-100"
    x-transition:leave-end="opacity-0 scale-95"
    class="relative bg-white rounded-xl shadow-2xl max-w-md w-full p-6"
  >
    <!-- Icono -->
    <div 
      class="w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4 bg-red-100"
      x-bind:class="getIconBgClass()"
    >
      <span 
        class="material-symbols-outlined text-2xl text-red-600"
        x-bind:class="getIconTextClass()"
        x-text="getIconName()"
      ></span>
    </div>
    
    <!-- Título -->
    <h3 class="text-lg font-bold text-gray-900 text-center mb-2" x-text="title"></h3>
    
    <!-- Mensaje -->
    <p class="text-gray-600 text-center mb-6" x-text="message"></p>
    
    <!-- Acciones -->
    <div class="flex gap-3 justify-center">
      <button 
        @click="cancel()"
        class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"
      >
        Cancelar
      </button>
      <button 
        @click="confirm()"
        class="px-4 py-2 rounded-lg font-medium transition-colors bg-red-600 hover:bg-red-700 text-white"
        x-bind:class="getConfirmBtnClass()"
        x-text="confirmText"
      ></button>
    </div>
  </div>
</div>

<script is:inline>
  function confirmModal() {
    return {
      isOpen: false,
      title: '',
      message: '',
      type: 'danger',
      confirmText: 'Confirmar',
      onConfirm: null,
      onCancel: null,
      
      getIconBgClass() {
        if (this.type === 'warning') return 'bg-yellow-100';
        if (this.type === 'info') return 'bg-blue-100';
        return 'bg-red-100';
      },
      
      getIconTextClass() {
        if (this.type === 'warning') return 'text-yellow-600';
        if (this.type === 'info') return 'text-blue-600';
        return 'text-red-600';
      },
      
      getIconName() {
        if (this.type === 'warning') return 'warning';
        if (this.type === 'info') return 'help';
        return 'delete';
      },
      
      getConfirmBtnClass() {
        if (this.type === 'warning') return 'bg-yellow-500 hover:bg-yellow-600 text-white';
        if (this.type === 'info') return 'bg-blue-600 hover:bg-blue-700 text-white';
        return 'bg-red-600 hover:bg-red-700 text-white';
      },
      
      show(opts) {
        this.title = opts.title || '';
        this.message = opts.message || '';
        this.type = opts.type || 'danger';
        this.confirmText = opts.confirmText || 'Confirmar';
        this.onConfirm = opts.onConfirm || null;
        this.onCancel = opts.onCancel || null;
        this.isOpen = true;
      },
      
      confirm() {
        if (this.onConfirm) this.onConfirm();
        this.isOpen = false;
      },
      
      cancel() {
        if (this.onCancel) this.onCancel();
        this.isOpen = false;
      }
    };
  }
  
  window.showConfirm = function(options) {
    window.dispatchEvent(new CustomEvent('show-confirm', { detail: options }));
  };
</script>

<style is:global>
  [x-cloak] { display: none !important; }
</style>
