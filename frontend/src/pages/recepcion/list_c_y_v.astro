---
export const prerender = false;

import DashboardLayout from '../../layouts/DashboardLayout.astro';
import Card from '../../components/ui/Card.astro';
import Button from '../../components/ui/Button.astro';
import Input from '../../components/ui/Input.astro';
import '../../styles/global.css';
import { strapiGet, strapiDelete } from '../../lib/strapi';

const userRole = Astro.cookies.get('user_role')?.value;

if (!userRole) {
  return Astro.redirect('/login');
}

let clientes = [];
let error = '';
let message = Astro.url.searchParams.get('message');
let messageType = Astro.url.searchParams.get('type');

try {
  const response = await strapiGet('/api/clientes?populate=vehiculos&sort=nombre:asc');
  clientes = response.data || [];
} catch (e) {
  console.error(e);
  error = 'Error al cargar clientes';
}

// Estad√≠sticas r√°pidas
const totalClientes = clientes.length;
const totalVehiculos = clientes.reduce((acc: number, c: any) => acc + (c.vehiculos?.length || 0), 0);
const clientesSinVehiculos = clientes.filter((c: any) => !c.vehiculos?.length).length;
---

<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

<script define:vars={{ clientes }}>
    document.addEventListener('alpine:init', () => {
        Alpine.data('clientListController', () => ({
            searchQuery: '',
            clients: clientes,
            expandedRows: {},
            filterVehiculos: 'all', // all, with, without
            showDeleteModal: false,
            clientToDelete: null,
            isDeleting: false,
            
            get filteredClients() {
                let result = this.clients;
                
                // Filtro por b√∫squeda
                if (this.searchQuery) {
                    const query = this.searchQuery.toLowerCase();
                    result = result.filter(c => 
                        c.nombre?.toLowerCase().includes(query) || 
                        c.apellido?.toLowerCase().includes(query) ||
                        c.rut?.toLowerCase().includes(query) ||
                        c.email?.toLowerCase().includes(query) ||
                        c.telefono?.includes(query) ||
                        c.direccion?.toLowerCase().includes(query) ||
                        c.comuna?.toLowerCase().includes(query) ||
                        c.vehiculos?.some(v => 
                            v.patente?.toLowerCase().includes(query) ||
                            v.marca?.toLowerCase().includes(query) ||
                            v.modelo?.toLowerCase().includes(query)
                        )
                    );
                }
                
                // Filtro por veh√≠culos
                if (this.filterVehiculos === 'with') {
                    result = result.filter(c => c.vehiculos?.length > 0);
                } else if (this.filterVehiculos === 'without') {
                    result = result.filter(c => !c.vehiculos?.length);
                }
                
                return result;
            },
            
            toggleRow(id) {
                this.expandedRows[id] = !this.expandedRows[id];
            },
            
            expandAll() {
                this.filteredClients.forEach(c => {
                    this.expandedRows[c.id] = true;
                });
            },
            
            collapseAll() {
                this.expandedRows = {};
            },
            
            confirmDelete(client) {
                this.clientToDelete = client;
                this.showDeleteModal = true;
            },
            
            async deleteClient() {
                if (!this.clientToDelete) return;
                
                this.isDeleting = true;
                try {
                    const response = await fetch(`/api/strapi/api/clientes/${this.clientToDelete.documentId}`, {
                        method: 'DELETE'
                    });
                    
                    if (response.ok) {
                        this.clients = this.clients.filter(c => c.id !== this.clientToDelete.id);
                        this.showDeleteModal = false;
                        this.clientToDelete = null;
                    } else {
                        alert('Error al eliminar el cliente');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error al eliminar el cliente');
                } finally {
                    this.isDeleting = false;
                }
            },
            
            formatPhone(phone) {
                if (!phone) return '-';
                // Formato: +56 9 1234 5678
                if (phone.length === 9) {
                    return `+56 ${phone.slice(0,1)} ${phone.slice(1,5)} ${phone.slice(5)}`;
                }
                return phone;
            },

            getCombustibleIcon(tipo) {
                const icons = {
                    'bencina': '‚õΩ',
                    'diesel': 'üõ¢Ô∏è',
                    'hibrido': 'üîã',
                    'electrico': '‚ö°',
                    'gas': 'üí®'
                };
                return icons[tipo] || 'üöó';
            }
        }));
    });
</script>

<DashboardLayout title="Listado de Clientes y Veh√≠culos" role="recepcionista" currentPath="/recepcion/list_c_y_v">
    <div class="w-full max-w-7xl mx-auto" x-data="clientListController">
        
        <!-- Server Message -->
        {message && (
            <div class={`p-4 mb-6 rounded-lg text-sm flex items-center gap-2 ${messageType === 'success' ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300' : 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300'}`} role="alert">
                <span class="material-symbols-outlined text-lg">{messageType === 'success' ? 'check_circle' : 'error'}</span>
                {message}
            </div>
        )}
        
        <!-- PageHeading -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 dark:text-white font-display">Gesti√≥n de Clientes y Veh√≠culos</h1>
                <p class="text-gray-500 dark:text-gray-400 text-sm mt-1">Consulta y administra clientes y sus veh√≠culos registrados</p>
            </div>
            <div class="flex gap-3">
                <a href="/recepcion/crear_vehiculo">
                    <Button variant="secondary" icon="directions_car">
                        Nuevo Veh√≠culo
                    </Button>
                </a>
                <a href="/recepcion/crear_cliente">
                    <Button icon="person_add">
                        Nuevo Cliente
                    </Button>
                </a>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700">
                <div class="flex items-center gap-3">
                    <div class="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg">
                        <span class="material-symbols-outlined text-blue-600 dark:text-blue-400">group</span>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900 dark:text-white">{totalClientes}</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Clientes registrados</p>
                    </div>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700">
                <div class="flex items-center gap-3">
                    <div class="p-3 bg-green-100 dark:bg-green-900/30 rounded-lg">
                        <span class="material-symbols-outlined text-green-600 dark:text-green-400">directions_car</span>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900 dark:text-white">{totalVehiculos}</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Veh√≠culos totales</p>
                    </div>
                </div>
            </div>
            <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700">
                <div class="flex items-center gap-3">
                    <div class="p-3 bg-amber-100 dark:bg-amber-900/30 rounded-lg">
                        <span class="material-symbols-outlined text-amber-600 dark:text-amber-400">warning</span>
                    </div>
                    <div>
                        <p class="text-2xl font-bold text-gray-900 dark:text-white">{clientesSinVehiculos}</p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Sin veh√≠culos</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toolbar: Search and Filters -->
        <div class="bg-white dark:bg-gray-800 rounded-xl p-4 mb-6 shadow-sm border border-gray-100 dark:border-gray-700">
            <div class="flex flex-col lg:flex-row gap-4 items-center">
                <!-- SearchBar -->
                <div class="flex-grow w-full lg:w-auto">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <span class="material-symbols-outlined text-gray-400">search</span>
                        </div>
                        <input 
                            x-model="searchQuery" 
                            class="block w-full pl-10 pr-3 py-2.5 border border-gray-200 dark:border-gray-700 rounded-lg leading-5 bg-gray-50 dark:bg-gray-900/50 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm transition duration-150 ease-in-out" 
                            placeholder="Buscar por nombre, RUT, tel√©fono, email, patente, marca..." 
                            type="text"
                        />
                    </div>
                </div>
                
                <!-- Filter por veh√≠culos -->
                <div class="flex items-center gap-2">
                    <span class="text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap">Filtrar:</span>
                    <select 
                        x-model="filterVehiculos"
                        class="px-3 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-900/50 text-gray-900 dark:text-white text-sm focus:ring-2 focus:ring-primary-500"
                    >
                        <option value="all">Todos</option>
                        <option value="with">Con veh√≠culos</option>
                        <option value="without">Sin veh√≠culos</option>
                    </select>
                </div>
                
                <!-- Expand/Collapse buttons -->
                <div class="flex items-center gap-2">
                    <button 
                        @click="expandAll()" 
                        class="px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors flex items-center gap-1"
                    >
                        <span class="material-symbols-outlined text-sm">unfold_more</span>
                        Expandir
                    </button>
                    <button 
                        @click="collapseAll()" 
                        class="px-3 py-2 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors flex items-center gap-1"
                    >
                        <span class="material-symbols-outlined text-sm">unfold_less</span>
                        Colapsar
                    </button>
                </div>
                
                <!-- Result count -->
                <div class="flex items-center px-2 whitespace-nowrap">
                    <p class="text-sm text-gray-600 dark:text-gray-400">
                      <span x-text="filteredClients.length" class="font-semibold text-gray-900 dark:text-white"></span> clientes
                    </p>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                    <thead class="text-xs text-gray-700 dark:text-gray-300 uppercase bg-gray-50 dark:bg-gray-900/50">
                        <tr>
                            <th class="p-4 w-4" scope="col"></th>
                            <th class="px-6 py-4 text-left font-semibold text-gray-900 dark:text-white" scope="col">Cliente</th>
                            <th class="px-6 py-4 text-left font-semibold text-gray-900 dark:text-white" scope="col">Contacto</th>
                            <th class="px-6 py-4 text-left font-semibold text-gray-900 dark:text-white hidden lg:table-cell" scope="col">Direcci√≥n</th>
                            <th class="px-6 py-4 text-center font-semibold text-gray-900 dark:text-white" scope="col">Veh√≠culos</th>
                            <th class="px-6 py-4 text-right font-semibold text-gray-900 dark:text-white" scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100 dark:divide-gray-700">
                        <template x-for="client in filteredClients" :key="client.id">
                            <tr>
                                <!-- Main Row -->
                                <td class="p-4">
                                    <button @click="toggleRow(client.id)" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                                        <span class="material-symbols-outlined text-gray-500" x-text="expandedRows[client.id] ? 'expand_less' : 'expand_more'"></span>
                                    </button>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center">
                                            <span class="text-primary-600 dark:text-primary-400 font-bold text-sm" x-text="(client.nombre?.[0] || '') + (client.apellido?.[0] || '')"></span>
                                        </div>
                                        <div>
                                            <div class="font-semibold text-gray-900 dark:text-white" x-text="`${client.nombre} ${client.apellido}`"></div>
                                            <div class="text-xs text-gray-500 font-mono" x-text="client.rut"></div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="space-y-1">
                                        <a :href="`tel:${client.telefono}`" class="flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-primary-600">
                                            <span class="material-symbols-outlined text-sm text-gray-400">phone</span>
                                            <span x-text="formatPhone(client.telefono)"></span>
                                        </a>
                                        <a :href="`mailto:${client.email}`" class="flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-primary-600">
                                            <span class="material-symbols-outlined text-sm text-gray-400">mail</span>
                                            <span class="truncate max-w-[180px]" x-text="client.email"></span>
                                        </a>
                                    </div>
                                </td>
                                <td class="px-6 py-4 hidden lg:table-cell">
                                    <template x-if="client.direccion || client.comuna">
                                        <div class="flex items-start gap-2">
                                            <span class="material-symbols-outlined text-sm text-gray-400 mt-0.5">location_on</span>
                                            <div>
                                                <div class="text-gray-600 dark:text-gray-300 text-sm" x-text="client.direccion || '-'"></div>
                                                <div class="text-xs text-gray-500" x-text="client.comuna || ''"></div>
                                            </div>
                                        </div>
                                    </template>
                                    <template x-if="!client.direccion && !client.comuna">
                                        <span class="text-gray-400 text-sm italic">Sin direcci√≥n</span>
                                    </template>
                                </td>
                                <td class="px-6 py-4 text-center">
                                    <button 
                                        @click="toggleRow(client.id)"
                                        class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-xs font-medium transition-colors"
                                        :class="client.vehiculos?.length > 0 ? 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/50' : 'bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400'"
                                    >
                                        <span class="material-symbols-outlined text-sm">directions_car</span>
                                        <span x-text="client.vehiculos?.length || 0"></span>
                                    </button>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="flex items-center justify-end gap-1">
                                        <!-- Agregar veh√≠culo -->
                                        <a 
                                            :href="`/recepcion/crear_vehiculo?cliente=${client.id}`" 
                                            class="p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-colors"
                                            title="Agregar veh√≠culo"
                                        >
                                            <span class="material-symbols-outlined text-lg">add_circle</span>
                                        </a>
                                        <!-- Editar -->
                                        <a 
                                            :href="`/recepcion/crear_cliente?id=${client.documentId}`" 
                                            class="p-2 text-gray-500 hover:text-primary-600 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-lg transition-colors"
                                            title="Editar cliente"
                                        >
                                            <span class="material-symbols-outlined text-lg">edit</span>
                                        </a>
                                        <!-- Eliminar -->
                                        <button 
                                            @click="confirmDelete(client)"
                                            class="p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
                                            title="Eliminar cliente"
                                        >
                                            <span class="material-symbols-outlined text-lg">delete</span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </template>
                        
                        <!-- Expanded vehicle details - using separate template -->
                        <template x-for="client in filteredClients" :key="'expanded-' + client.id">
                            <tr x-show="expandedRows[client.id]" x-transition class="bg-gray-50/50 dark:bg-gray-900/20">
                                <td colspan="6" class="px-6 py-4">
                                    <div class="ml-8">
                                        <div class="flex items-center justify-between mb-4">
                                            <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider flex items-center gap-2">
                                                <span class="material-symbols-outlined text-sm">directions_car</span>
                                                Veh√≠culos de <span x-text="client.nombre"></span>
                                            </h4>
                                            <a 
                                                :href="`/recepcion/crear_vehiculo?cliente=${client.id}`"
                                                class="text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1"
                                            >
                                                <span class="material-symbols-outlined text-sm">add</span>
                                                Agregar veh√≠culo
                                            </a>
                                        </div>
                                        <template x-if="client.vehiculos?.length > 0">
                                            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                                                <template x-for="vehiculo in client.vehiculos" :key="vehiculo.id">
                                                    <div class="bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow">
                                                        <div class="flex justify-between items-start mb-3">
                                                            <div>
                                                                <p class="font-bold text-gray-900 dark:text-white" x-text="`${vehiculo.marca} ${vehiculo.modelo}`"></p>
                                                                <p class="text-lg font-mono text-primary-600 dark:text-primary-400 font-bold" x-text="vehiculo.patente"></p>
                                                            </div>
                                                            <div class="flex items-center gap-1">
                                                                <span x-text="getCombustibleIcon(vehiculo.tipo_combustible)" class="text-lg"></span>
                                                            </div>
                                                        </div>
                                                        <div class="grid grid-cols-2 gap-2 text-sm">
                                                            <div class="flex items-center gap-2 text-gray-500">
                                                                <span class="material-symbols-outlined text-xs">calendar_today</span>
                                                                <span>A√±o: <span class="text-gray-700 dark:text-gray-300" x-text="vehiculo.ano || '-'"></span></span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-500" x-show="vehiculo.color">
                                                                <span class="material-symbols-outlined text-xs">palette</span>
                                                                <span x-text="vehiculo.color"></span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-500" x-show="vehiculo.kilometraje">
                                                                <span class="material-symbols-outlined text-xs">speed</span>
                                                                <span x-text="vehiculo.kilometraje?.toLocaleString() + ' km'"></span>
                                                            </div>
                                                            <div class="flex items-center gap-2 text-gray-500" x-show="vehiculo.numero_de_chasis">
                                                                <span class="material-symbols-outlined text-xs">tag</span>
                                                                <span class="font-mono text-xs truncate" x-text="vehiculo.numero_de_chasis"></span>
                                                            </div>
                                                        </div>
                                                        <div class="mt-3 pt-3 border-t border-gray-100 dark:border-gray-700 flex justify-between items-center">
                                                            <a 
                                                                :href="`/recepcion/historial_vehiculo?id=${vehiculo.documentId}`"
                                                                class="text-xs text-primary-600 hover:text-primary-700 flex items-center gap-1"
                                                            >
                                                                <span class="material-symbols-outlined text-sm">history</span>
                                                                Ver historial
                                                            </a>
                                                            <a 
                                                                :href="`/recepcion/crear_orden?vehiculo=${vehiculo.documentId}`"
                                                                class="text-xs bg-primary-600 text-white px-3 py-1.5 rounded-lg hover:bg-primary-700 flex items-center gap-1"
                                                            >
                                                                <span class="material-symbols-outlined text-sm">add</span>
                                                                Nueva orden
                                                            </a>
                                                        </div>
                                                    </div>
                                                </template>
                                            </div>
                                        </template>
                                        <template x-if="!client.vehiculos?.length">
                                            <div class="text-center py-8 bg-white dark:bg-gray-800 rounded-xl border border-dashed border-gray-200 dark:border-gray-700">
                                                <span class="material-symbols-outlined text-4xl text-gray-300 dark:text-gray-600 mb-2">directions_car</span>
                                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-3">No hay veh√≠culos registrados</p>
                                                <a 
                                                    :href="`/recepcion/crear_vehiculo?cliente=${client.id}`"
                                                    class="inline-flex items-center gap-1 text-sm text-primary-600 hover:text-primary-700"
                                                >
                                                    <span class="material-symbols-outlined text-sm">add</span>
                                                    Registrar primer veh√≠culo
                                                </a>
                                            </div>
                                        </template>
                                    </div>
                                </td>
                            </tr>
                        </template>
                        
                        <!-- Empty state -->
                        <template x-if="filteredClients.length === 0">
                            <tr>
                                <td colspan="6" class="px-6 py-12 text-center">
                                    <span class="material-symbols-outlined text-5xl text-gray-300 dark:text-gray-600 mb-3">search_off</span>
                                    <p class="text-gray-500 dark:text-gray-400 mb-4">No se encontraron clientes con los filtros actuales.</p>
                                    <a href="/recepcion/crear_cliente" class="inline-flex items-center gap-2 text-primary-600 hover:text-primary-700">
                                        <span class="material-symbols-outlined">person_add</span>
                                        Registrar nuevo cliente
                                    </a>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Delete Modal -->
        <div 
            x-show="showDeleteModal" 
            x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0"
            x-transition:enter-end="opacity-100"
            x-transition:leave="transition ease-in duration-150"
            x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"
            @click.self="showDeleteModal = false"
        >
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl max-w-md w-full mx-4 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="p-3 bg-red-100 dark:bg-red-900/30 rounded-full">
                        <span class="material-symbols-outlined text-red-600 dark:text-red-400">warning</span>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">Eliminar Cliente</h3>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Esta acci√≥n no se puede deshacer</p>
                    </div>
                </div>
                
                <p class="text-gray-600 dark:text-gray-300 mb-6">
                    ¬øEst√°s seguro de que deseas eliminar a 
                    <span class="font-semibold" x-text="clientToDelete ? `${clientToDelete.nombre} ${clientToDelete.apellido}` : ''"></span>?
                    <template x-if="clientToDelete?.vehiculos?.length > 0">
                        <span class="text-red-600 dark:text-red-400"> Este cliente tiene <span x-text="clientToDelete.vehiculos.length"></span> veh√≠culo(s) registrado(s).</span>
                    </template>
                </p>
                
                <div class="flex justify-end gap-3">
                    <button 
                        @click="showDeleteModal = false"
                        class="px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
                    >
                        Cancelar
                    </button>
                    <button 
                        @click="deleteClient()"
                        :disabled="isDeleting"
                        class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"
                    >
                        <span class="material-symbols-outlined text-lg animate-spin" x-show="isDeleting">progress_activity</span>
                        <span x-text="isDeleting ? 'Eliminando...' : 'Eliminar'"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</DashboardLayout>